## Pyspy: analyze and visualize data output by Phantom

### Content

This repo contains python package I wrote for processing and analyzing simulation results obtained from PHANTOM, so as to investigate formation of galactic spirals in gaseous discs driven by different machanisms. 

**All images displayed below are owned by Ying Zhang.** 

**All references, please refer to the last section in my thesis.**

### Why I put it here? 

For some reasons, I don't have a chance to refine or publish this work at this moment. I hope, at least, I could put my work here for people might be working on the same specific field such that they could avoid doing possible redundant work. And I also upload a copy of my master's thesis in case you need more details.

With this python package, we could preprocess data obtained from PHANTOM to grid the galactic discs and calculate the number density, averaged azimuthal velocity and radial velocity in order to analyze particle dynamics. We could also fit them with a Fourier mode so as to analyze the spiarl patterns quantitatively.  

### What is not here?

I didn't provide any dataset here since this work might possibly get published someday. 
The code I had implemented in PHANTOM to conduct simulations is not here, either. So, in order to utilize the code, you need to be a PHANTOM user and convert your bianry output data file to ascii format via SPLASH.

### Brief intro 

**Rotation Curve**: Section 2.2.1 Initial surface density

set up paramters for galactic components in <code>src/phycon</code>, and use module <code>src/roCurve</code> to load data, we could obatined the following plot, which demostrates predicted rotation curve and true gas particles generated by PHANTOM. 

<img src="https://github.com/martianying/Pyspy/blob/master/images/roCurve.png" width="400" height="300">

**Initial setup**: Section 2.2.1 Initial surface density

Use module <code>src/iniDensity</code>, we could obatain the following plots. Note that for real initial setup in PHANTOM, you need to run the blank galaxy for rougly 1Gyr to achieve an equilibrium.
Left is real distribution generated by PHTANOM (very proud of myself to have coded this in Fortran language!) Right is the predicted one.

<p float="left">
  <img src="https://github.com/martianying/Pyspy/blob/master/images/equilibrium.png" width="400" height="300" />
  <img src="https://github.com/martianying/Pyspy/blob/master/images/ini_python.png" width="400" height="300" />
</p>

**Potential contour plot**: Section 2.3 Perturbation Methods

Use module <code>src/potentials</code>, we could check how the different potential in our simulations. Below is Cox&Gomez arm potential with winding effect and an activiation function.

 <img src="https://github.com/martianying/Pyspy/blob/master/images/contour.png" width="700" height="350" />

**Activation function and logged r-θ heatmap**: Section 3.1 Analysis Methods

For the left, use module <code>src/growth</code>, we could obatin the plot below. we need them since it helps us avoid hitting galaxies. For the right, use module <code>src/growth</code>, we could demostrate logged r-θ density heatmap. If those arms are straight segments in the plot, we could fairly address they are logrithmic.

<p float="left">
  <img src="https://github.com/martianying/Pyspy/blob/master/images/AFs.png" width="325" height="325" />
  <img src="https://github.com/martianying/Pyspy/blob/master/images/heatmap.png" width="400" height="350" />
</p>

**partical dynamics**: Section 3.1 Analysis Methods

with module <code>src/growth</code> and <code>src/spiralFit</code>, we could obtain heatmap of density, averaged azimuthal velocity and radial velocity. And also fit the data with Fourier analysis. (for more details, please refer to my thesis Section 3.1.2, it is sort of math heavy.)

<p float="left">
  <img src="https://github.com/martianying/Pyspy/blob/master/images/phase.png" width="420" height="320" />
  <img src="https://github.com/martianying/Pyspy/blob/master/images/dynamics.png" width="400" height="300" />
</p>


**I would be really happy if this repo could be some kind of help for people doing research in this field.**

**My last physics project with love.**
